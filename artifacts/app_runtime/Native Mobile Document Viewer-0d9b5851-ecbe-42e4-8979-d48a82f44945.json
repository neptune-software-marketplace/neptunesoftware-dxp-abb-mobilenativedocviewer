{
	"id": "0d9b5851-ecbe-42e4-8979-d48a82f44945",
	"createdAt": "2022-02-04T15:48:05.393Z",
	"updatedAt": "2022-07-26T11:12:52.753Z",
	"createdBy": "luuk.wosten@neptune-software.com",
	"changedBy": "kristin.eliassen@neptune-software.com",
	"objects": [
		{
			"fieldNo": "1e2abb8d-30f0-4cbe-bc34-8b3c0b248943",
			"fieldName": "oShell",
			"fieldParent": 0,
			"fieldType": "sap.m.Shell",
			"script": "",
			"request": [],
			"response": [],
			"attributes": [
				{
					"attribute": "visible",
					"grouping": "Properties",
					"value": true,
					"script": "",
					"translation": []
				},
				{
					"attribute": "showLogout",
					"grouping": "Properties",
					"value": true,
					"script": "",
					"translation": []
				},
				{
					"attribute": "appWidthLimited",
					"grouping": "Properties",
					"value": true,
					"script": "",
					"translation": []
				}
			],
			"data": []
		},
		{
			"fieldNo": "31693039-c9f2-4095-b976-71630c8a66eb",
			"fieldName": "Functions",
			"fieldParent": 0,
			"fieldType": "neptune.Script",
			"script": [
				"==OBJECT STRING==",
				"// Init",
				"sap.ui.getCore().attachInit(function(data) {",
				"",
				"    if (!data.content) {",
				"        alert(\"No content given in startParams\");",
				"        closeApp();",
				"        return;",
				"    }",
				"",
				"    if (!data.mimeType) {",
				"        alert(\"No mimeType given in startParams\");",
				"        closeApp();",
				"        return;",
				"    }",
				"",
				"    if (!data.fileName) {",
				"        alert(\"No fileName given in startParams\");",
				"        closeApp();",
				"        return;",
				"    }",
				"",
				"    // Desktop",
				"    if (sap.ui.Device.system.desktop) {",
				"        alert(\"This app must exclusively used in a mobile device\");",
				"        closeApp();",
				"        return;",
				"    }",
				"",
				"    // Phone / Tablet",
				"    if (sap.ui.Device.system.phone || sap.ui.Device.system.tablet) {",
				"",
				"        if (typeof cordova === \"undefined\") {",
				"            alert(\"You need to test in a Mobile App\");",
				"            closeApp();",
				"        } else {",
				"            nativeOpen(data.content, data.mimeType, data.fileName);",
				"        }",
				"        return;",
				"    }",
				"});",
				"",
				"",
				"// ---------------------------------------------------",
				"// Common functions",
				"// ---------------------------------------------------",
				"makeBinary = function(pdfBase64) {",
				"",
				"    var raw = window.atob(pdfBase64);",
				"    var rawLength = raw.length;",
				"",
				"    var array = new Uint8Array(rawLength);",
				"    for (i = 0; i < rawLength; i++) {",
				"        array[i] = raw.charCodeAt(i);",
				"    }",
				"    return array;",
				"}",
				"",
				"",
				"// ---------------------------------------------------",
				"// Open mobile native Reader",
				"// ---------------------------------------------------",
				"nativeOpen = function(content, mimeType, fileName) {",
				"",
				"    // Set Directory",
				"    switch (sap.ui.Device.os.name) {",
				"",
				"        case 'Android':",
				"            nativeDir = cordova.file.externalCacheDirectory;",
				"            break;",
				"",
				"        case 'iOS':",
				"            nativeDir = cordova.file.tempDirectory;",
				"            break;",
				"",
				"        case 'winphone':",
				"            nativeDir = cordova.file.externalCacheDirectory;",
				"            break;",
				"",
				"            // Windows 10 Client",
				"        case 'win':",
				"            nativeDir = cordova.file.cacheDirectory;",
				"            break;",
				"",
				"        default:",
				"            break;",
				"    }",
				"",
				"    // Create Array",
				"    dataArray = makeBinary(content);",
				"",
				"    // Create and Display File",
				"    window.resolveLocalFileSystemURL(nativeDir, function(dir) {",
				"        dir.getFile(fileName, {",
				"            create: true",
				"        }, function(file) {",
				"            nativeWriteLog(file, mimeType, nativeDir, fileName, dataArray);",
				"        });",
				"    });",
				"",
				"}",
				"",
				"nativeWriteLog = function(file, mimeType, nativeDir, fileName, dataArray) {",
				"",
				"    file.createWriter(function(fileWriter) {",
				"        fileWriter.onwriteend = function(e) {",
				"            cordova.plugins.fileOpener2.open(",
				"                nativeDir + fileName,",
				"                mimeType, {",
				"                    error: function(e) {",
				"                        console.log('Error open: ' + e.status + ' - Error message: ' + e.message);",
				"                        closeApp();",
				"                    },",
				"                    success: function() {",
				"                        closeApp();",
				"                    }",
				"                }",
				"            );",
				"        };",
				"",
				"        fileWriter.onerror = function(e) {",
				"            console.log('WRITE ERROR is');",
				"            console.log(e);",
				"        };",
				"",
				"        var blob = new Blob([dataArray], {",
				"            type: mimeType",
				"        });",
				"        fileWriter.write(blob);",
				"",
				"    }, nativeWriteFail);",
				"}",
				"",
				"nativeWriteFail = function(e) {",
				"    console.log('Error write: ' + e.status + ' - Error message: ' + e.message);",
				"}",
				"",
				"// App commits suicide",
				"closeApp = function() {",
				"",
				"    setTimeout(function() {",
				"",
				"        // Clear View",
				"        if (AppCache.View[localAppID]) {",
				"            AppCache.View[localAppID].removeAllContent();",
				"            AppCache.View[localAppID].destroy();",
				"            AppCache.View[localAppID] = null;",
				"            delete AppCache.View[localAppID];",
				"        }",
				"",
				"        // Clear All Events",
				"        delete sap.n.Apps[localAppID];",
				"    }, 300);",
				"}",
				""
			],
			"onlyDeclare": true,
			"request": [],
			"response": [],
			"attributes": [],
			"data": []
		},
		{
			"fieldNo": 99999,
			"data": []
		},
		{
			"fieldNo": 99998,
			"data": []
		}
	],
	"ver": "22.7.26.1312",
	"application": "neptbb_native_docviewer",
	"title": "Native Mobile Document Viewer",
	"description": "UTIL",
	"enableFileStorage": false,
	"enableManifest": false,
	"enableStylesheet": false,
	"enableObfuscate": false,
	"onlyRunLaunchpad": false,
	"disabled": false,
	"loadLaunchpadCode": null,
	"loadApplicationCode": null,
	"appType": "C",
	"ui5_m": true,
	"ui5_f": false,
	"ui5_table": false,
	"ui5_tnt": false,
	"ui5_uxap": false,
	"ui5_chart": false,
	"ui5_theme": "sap_belize",
	"ui5_version": "",
	"ui5_language": null,
	"cus_theme": "",
	"css": "",
	"header": "",
	"manifest": "",
	"globalScript": "",
	"deleted": false,
	"libHighchart": false,
	"libHighmap": false,
	"publicAccess": false,
	"ui5_bootstrap": false,
	"apis": []
}